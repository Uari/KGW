<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.mapper.DocumentMapper">

    <select id="selectDocument" parameterType="com.vo.ApprovalVO" resultType="com.vo.ApprovalVO">
    SELECT * FROM document   LEFT JOIN approval ON document.document_no = approval.document_no
        <where>
            <if test="gubun !=null">
                <choose>
                    <when test='gubun.equals("true")'>
                        AND document.state = '임시저장'
                    </when>
                    <when test='gubun.equals("false")'>
                        AND document.state != '임시저장'
                    </when>
                </choose>
            </if>
        </where>
        order by document.document_no asc
        </select>


        <!--   결재자 select -->
    <select id="approvalDocument" parameterType="com.vo.ApprovalVO" resultType="com.vo.ApprovalVO">
        SELECT
            d.*, a.*
        FROM
            document d
                INNER JOIN
            approval a ON d.document_no = a.document_no
    </select>




<!--영입 계약필요한 데이터 -->
    <select id="faTeam">
        select * from fa where fa_team !='키움';
    </select>



    <select id="k_List" parameterType="com.vo.ApprovalVO" resultType="map">
        SELECT k_no, k_name
        FROM kiwoom
    </select>




<!--영입 문서만 insert-->
    <insert id="documentInsert" parameterType="com.vo.ApprovalVO" useGeneratedKeys="true" keyColumn="document_no" keyProperty="document_no">
        INSERT INTO document (
            document_no,
            emp_no,
            document_title,
            document_category,
            k_no,
            start_date,
            end_date,
            dayoff_content,
            salary,
            contract_term
        )
        VALUES (
               document_pk_seq.nextval,
               #{emp_no},
               #{document_title},
               #{document_category},
               #{k_no},
               TO_DATE(#{start_date,jdbcType=VARCHAR}, 'YYYY-MM-DD'),
               TO_DATE(#{end_date,jdbcType=VARCHAR}, 'YYYY-MM-DD'),
               #{dayoff_content,jdbcType=INTEGER},
               #{salary,jdbcType=INTEGER},
               #{contract_term,jdbcType=VARCHAR}
               )
    </insert>


    <insert id="approvalInsert" parameterType="com.vo.ApprovalVO" >
        INSERT INTO approval (
        approval_no, document_no, approval_name, approval_category,
        rejection_content, middle_approval_date, final_approval_date, middleSign_img, finalSign_img)
        VALUES (approval_pk_seq.nextval, #{document_no}, #{approval_name, jdbcType=VARCHAR}, #{approval_category,jdbcType=VARCHAR},
                #{rejection_content, jdbcType=VARCHAR}, #{middle_approval_date, jdbcType=VARCHAR}, #{final_approval_date, jdbcType=VARCHAR},  #{middleSign_img, jdbcType=VARCHAR}, #{finalSign_img, jdbcType=VARCHAR})
    </insert>






<!--    INSERT INTO document (-->
<!--    document_no,-->
<!--    emp_no,-->
<!--    document_title,-->
<!--    document_category,-->
<!--    k_no,-->
<!--    start_date,-->
<!--    end_date,-->
<!--    dayoff_content,-->
<!--    salary,-->
<!--    contract_term-->

<!--    )-->
<!--    VALUES (-->
<!--    document_pk_seq.nextval,-->
<!--    #{emp_no},-->
<!--    #{document_title},-->
<!--    #{document_category},-->
<!--    #{k_no},-->
<!--    #{start_date},-->
<!--    #{end_date},-->
<!--    #{dayoff_content},-->
<!--    #{salary},-->
<!--    #{contract_term},-->

<!--    )-->
</mapper>


